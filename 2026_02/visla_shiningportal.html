<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  width: 100%;
  height: 100%;
  background: transparent;
  overflow: hidden;
}
body {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
}

#slideshow {
  position: relative;
  width: 100%;
  overflow: hidden;
}

/* 슬라이드 트랙 - 가로로 나열 */
#track {
  display: flex;
  transition: transform 0.45s cubic-bezier(0.4, 0, 0.2, 1);
  will-change: transform;
}

.slide {
  flex: 0 0 100%;
  width: 100%;
}

/* before/after 컨테이너 */
.container {
  position: relative;
  width: 100%;
  aspect-ratio: 4 / 3;
  overflow: hidden;
}
.img-wrapper {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.img-wrapper:nth-child(2) {
  clip-path: inset(0px 0px 0px 50%);
}
.img-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}
.line {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  width: .15rem;
  height: 100%;
  background-color: #fff;
  pointer-events: none;
}
input[type=range] {
  appearance: none;
  -webkit-appearance: none;
  background: transparent;
  position: absolute;
  width: calc(100% + 2.25rem);
  height: 100%;
  left: -1.125rem;
  top: 0;
  cursor: pointer;
}
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  height: 2.25rem;
  width: 2.25rem;
  border: .25rem solid #fff;
  border-radius: 50%;
  box-shadow: 0 0 8px 2px rgba(0,0,0,0.2);
  background-color: #fff;
  background-image: url('data:image/svg+xml;utf8,%3Csvg xmlns%3D%22http%3A//www.w3.org/2000/svg%22 height%3D%2224px%22 viewBox%3D%220 -960 960 960%22 width%3D%2224px%22 fill%3D%22%23000%22%3E%3Cpath d%3D%22M286.15-293.85 100-479.62l185.77-185.76 42.15 41.76-113 113.62h530.16l-113-113.62 42.15-41.76L860-479.62 674.23-293.85l-42.54-41.77 113.39-114H214.54l113.38 114-41.77 41.77Z%22/%3E%3C/svg%3E');
  background-size: cover;
  cursor: grab;
}
input[type=range]::-moz-range-thumb {
  height: 2.25rem;
  width: 2.25rem;
  border: .25rem solid #fff;
  border-radius: 50%;
  box-shadow: 0 0 8px 2px rgba(0,0,0,0.2);
  background-color: #fff;
  background-image: url('data:image/svg+xml;utf8,%3Csvg xmlns%3D%22http%3A//www.w3.org/2000/svg%22 height%3D%2224px%22 viewBox%3D%220 -960 960 960%22 width%3D%2224px%22 fill%3D%22%23000%22%3E%3Cpath d%3D%22M286.15-293.85 100-479.62l185.77-185.76 42.15 41.76-113 113.62h530.16l-113-113.62 42.15-41.76L860-479.62 674.23-293.85l-42.54-41.77 113.39-114H214.54l113.38 114-41.77 41.77Z%22/%3E%3C/svg%3E');
  background-size: cover;
  cursor: grab;
}
input[type=range]:active::-webkit-slider-thumb { cursor: grabbing; }
input[type=range]:active::-moz-range-thumb { cursor: grabbing; }

/* 화살표 */
.nav-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255,255,255,0.75);
  border: none;
  border-radius: 50%;
  width: 2rem;
  height: 2rem;
  font-size: 1.2rem;
  cursor: pointer;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #333;
  transition: background 0.2s;
  line-height: 1;
}
.nav-btn:hover { background: rgba(255,255,255,0.95); }
#prev { left: .5rem; }
#next { right: .5rem; }

/* 점 인디케이터 */
#dots {
  display: flex;
  gap: .5rem;
  justify-content: center;
  padding: .6rem 0;
}
.dot {
  width: .45rem;
  height: .45rem;
  border-radius: 50%;
  background: #ccc;
  cursor: pointer;
  transition: background 0.2s;
}
.dot.active { background: #333; }
</style>
</head>
<body>

<div id="slideshow">
  <div id="track">
    <div class="slide" data-set="C09"></div>
    <div class="slide" data-set="C11"></div>
    <div class="slide" data-set="C31"></div>
    <div class="slide" data-set="C38-3"></div>
    <div class="slide" data-set="C42"></div>
    <div class="slide" data-set="C46"></div>
    <div class="slide" data-set="C55"></div>
  </div>
  <button class="nav-btn" id="prev">&#8249;</button>
  <button class="nav-btn" id="next">&#8250;</button>
</div>

<div id="dots"></div>

<script>
  const slides = document.querySelectorAll('.slide');
  const track  = document.getElementById('track');
  const dotsEl = document.getElementById('dots');
  let current  = 0;
  let animating = false;

  // 슬라이드 빌드
  slides.forEach((slide) => {
    const set = slide.dataset.set;
    slide.innerHTML = `
      <div class="container">
        <div class="img-wrapper"><img src="../image/${set}_CLEAN.png" alt="Before"></div>
        <div class="img-wrapper"><img src="../image/${set}_FINAL.png" alt="After"></div>
        <div class="line"></div>
        <input type="range" min="0" max="100" value="50">
      </div>
    `;
    const input = slide.querySelector('input');
    const line  = slide.querySelector('.line');
    const after = slide.querySelector('.img-wrapper:nth-of-type(2)');
    input.addEventListener('input', () => {
      line.style.left = input.value + '%';
      after.style.clipPath = 'inset(0px 0px 0px ' + input.value + '%)';
    });
    input.addEventListener('dblclick', () => {
      input.value = 50;
      line.style.left = '50%';
      after.style.clipPath = 'inset(0px 0px 0px 50%)';
    });
  });

  // 점 생성
  slides.forEach((_, i) => {
    const dot = document.createElement('div');
    dot.className = 'dot' + (i === 0 ? ' active' : '');
    dot.addEventListener('click', () => goTo(i));
    dotsEl.appendChild(dot);
  });

  function goTo(n) {
    if (animating || n === current) return;
    animating = true;
    dotsEl.children[current].classList.remove('active');
    current = (n + slides.length) % slides.length;
    track.style.transform = `translateX(-${current * 100}%)`;
    dotsEl.children[current].classList.add('active');
    setTimeout(() => { animating = false; }, 450);
  }

  document.getElementById('prev').addEventListener('click', () => goTo(current - 1));
  document.getElementById('next').addEventListener('click', () => goTo(current + 1));

  // 터치 스와이프 지원
  let touchStartX = 0;
  track.addEventListener('touchstart', e => { touchStartX = e.touches[0].clientX; }, { passive: true });
  track.addEventListener('touchend', e => {
    const diff = touchStartX - e.changedTouches[0].clientX;
    if (Math.abs(diff) > 40) goTo(diff > 0 ? current + 1 : current - 1);
  });
</script>

</body>
</html>
